-- 验证修复后的itemid数量
WITH mechanical_itemids AS (
    SELECT unnest(ARRAY[
        -- ECMO (25个)
        224660, 229270, 229272, 229268, 229271, 229277, 229278, 229280, 229276,
        229274, 229266, 229363, 229364, 229365, 229269, 229275, 229267, 229273,
        228193, 229256, 229258, 229264, 229250, 229262, 229254, 229252, 229260,
        -- IABP (17个)
        224322, 227980, 225988, 228866, 225339, 225982, 226110, 225985, 225986,
        225341, 225981, 225979, 225987, 225342, 225984, 225980, 227754, 227355,
        225742,
        -- Impella (16个)
        228154, 229679, 228173, 228164, 228162, 228174, 229680, 229897,
        229671, 228171, 228172, 228167, 228170, 224314, 224318, 229898,
        -- LVAD (9个)
        220128
    ]) as itemid
)
SELECT
    COUNT(*) as total_itemids,
    COUNT(DISTINCT itemid) as unique_itemids,
    COUNT(*) - COUNT(DISTINCT itemid) as duplicates_count
FROM mechanical_itemids;