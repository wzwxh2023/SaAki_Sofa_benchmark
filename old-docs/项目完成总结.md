# MIMIC-IV æŠ€èƒ½åˆ›å»ºä¸æ•°æ®åº“è¿æ¥ - é¡¹ç›®å®Œæˆæ€»ç»“

**å®Œæˆæ—¥æœŸ**: 2025å¹´11æœˆ14æ—¥
**é¡¹ç›®çŠ¶æ€**: âœ… å…¨éƒ¨å®Œæˆå¹¶å¯ç”¨
**æ•°æ®åº“çŠ¶æ€**: âœ… å·²è¿æ¥å¹¶æµ‹è¯•

---

## ğŸ¯ é¡¹ç›®æˆæœ

### âœ… å·²å®Œæˆçš„ä¸»è¦å·¥ä½œ

#### 1. Claude AI æŠ€èƒ½åˆ›å»º
- **ä½ç½®**: `.claude/skills/mimiciv-data-extraction/`
- **å¤§å°**: 28KB æ ¸å¿ƒå†…å®¹
- **åŒ…å«**:
  - å®Œæ•´çš„ MIMIC-IV è¡¨ç»“æ„æ–‡æ¡£ï¼ˆ111ä¸ªè¡¨ï¼‰
  - ItemID å¿«é€Ÿå‚è€ƒï¼ˆç”Ÿå‘½ä½“å¾ã€å®éªŒå®¤æ£€æŸ¥ã€è¯ç‰©ç­‰ï¼‰
  - ä¸´åºŠæ¦‚å¿µ SQL å®ç°ï¼ˆSOFAã€Sepsis-3ã€KDIGO AKIï¼‰
  - æ•°æ®æå–æ¨¡å¼å’ŒæŸ¥è¯¢æ¨¡æ¿
  - æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### 2. æ•°æ®åº“è¿æ¥é…ç½®
- **ä¸»æœº**: 172.19.160.1
- **ç«¯å£**: 5432
- **æ•°æ®åº“**: mimiciv
- **çŠ¶æ€**: âœ… è¿æ¥æˆåŠŸ
- **å·¥å…·**: `utils/db_helper.py` å·²é…ç½®

#### 3. æ•°æ®åº“å®Œæ•´æ¢ç´¢
- **æ€» Schema**: 3 ä¸ªï¼ˆhosp, icu, derivedï¼‰
- **æ€»è¡¨æ•°**: 111 ä¸ª
- **æ€»æ•°æ®è¡Œ**: è¶…è¿‡ 6.2 äº¿
- **æ•°æ®åº“å¤§å°**: çº¦ 80 GB

#### 4. å®Œæ•´ä¸­è‹±æ–‡æ–‡æ¡£
- **ä¸­æ–‡æ–‡æ¡£** (4ä¸ª):
  - å®Œæ•´æµç¨‹æ€»ç»“
  - å¿«é€Ÿå¼€å§‹æŒ‡å—
  - å…³é”®èµ„æºé€ŸæŸ¥è¡¨
  - æ–‡æ¡£ç´¢å¼•
- **è‹±æ–‡æ–‡æ¡£** (3ä¸ª):
  - æŠ€èƒ½æ ¸å¿ƒæ–‡æ¡£ï¼ˆSKILL.mdï¼‰
  - æŠ€èƒ½ä½¿ç”¨æŒ‡å—ï¼ˆREADME.mdï¼‰
  - æ•°æ®åº“æ‘˜è¦

---

## ğŸ“Š å…³é”®æ•°æ®ç»Ÿè®¡

### æ ¸å¿ƒè¡¨æ•°æ®é‡

| ç±»åˆ« | è¡¨å | æ•°æ®é‡ |
|------|------|---------|
| **æ‚£è€…ä¿¡æ¯** | patients | 364,627 äºº |
| **ä½é™¢è®°å½•** | admissions | 546,028 æ¬¡ |
| **ICU ä½é™¢** | icustays | 94,458 æ¬¡ |
| **å®éªŒå®¤æ£€æŸ¥** | labevents | 158,478,383 æ¡ |
| **ICU å›¾è¡¨äº‹ä»¶** | chartevents | 432,997,491 æ¡ |
| **å¤„æ–¹è®°å½•** | prescriptions | 20,292,611 æ¡ |

### é¢„è®¡ç®—ä¸´åºŠæ¦‚å¿µï¼ˆé‡è¦ï¼ï¼‰

| æ¦‚å¿µ | è¡¨å | æ•°æ®é‡ | è¯´æ˜ |
|------|------|---------|------|
| **SOFA è¯„åˆ†** | sofa | 8,219,121 æ¡ | æ—¶é—´åºåˆ— |
| **é¦–æ—¥ SOFA** | first_day_sofa | 94,458 æ¡ | æ¯ä¸ª ICU ä½é™¢ä¸€æ¡ |
| **è„“æ¯’ç—‡** | sepsis3 | 41,295 ä¾‹ | å·²è¯†åˆ«çš„ Sepsis-3 ç—…ä¾‹ |
| **AKI åˆ†æœŸ** | kdigo_stages | 5,099,899 æ¡ | KDIGO æ ‡å‡† |

**å¥½æ¶ˆæ¯**: è¿™äº›ä¸´åºŠæ¦‚å¿µéƒ½å·²ç»é¢„å…ˆè®¡ç®—å¥½ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼

---

## ğŸ“ åˆ›å»ºçš„æ–‡ä»¶æ¸…å•

### æŠ€èƒ½æ–‡ä»¶
```
.claude/skills/mimiciv-data-extraction/
â”œâ”€â”€ SKILL.md          (28KB) - æ ¸å¿ƒæŠ€èƒ½å†…å®¹
â”œâ”€â”€ README.md         (5.2KB) - ä½¿ç”¨æŒ‡å—
â””â”€â”€ skill.json        (1.7KB) - å…ƒæ•°æ®
```

### ä¸­æ–‡æ–‡æ¡£
```
docs/å®Œæ•´æµç¨‹æ–‡æ¡£/
â”œâ”€â”€ README.md                      - æ–‡æ¡£ç´¢å¼•å’Œå¯¼èˆª
â”œâ”€â”€ 01_å®Œæ•´æµç¨‹æ€»ç»“.md              - ä»æŠ€èƒ½åˆ›å»ºåˆ°æ•°æ®åº“è¿æ¥çš„å®Œæ•´è¿‡ç¨‹
â”œâ”€â”€ 02_å¿«é€Ÿå¼€å§‹æŒ‡å—.md              - 5åˆ†é’Ÿå¿«é€Ÿå¼€å§‹
â””â”€â”€ 03_å…³é”®èµ„æºé€ŸæŸ¥è¡¨.md            - è¡¨åã€ItemIDã€SQL æ¨¡å¼é€ŸæŸ¥
```

### è‹±æ–‡æ–‡æ¡£
```
MIMICIV_Database_Summary.md        - æ•°æ®åº“å®Œæ•´æ‘˜è¦
é…ç½®æ­¥éª¤_PostgreSQLè¿æ¥.md         - è¿æ¥é…ç½®æŒ‡å—
```

### é…ç½®å’Œå·¥å…·
```
utils/db_helper.py                 - æ•°æ®åº“è¿æ¥å·¥å…· âœ… å·²é…ç½®
scripts/explore_mimiciv_database.py - æ•°æ®åº“æ¢ç´¢è„šæœ¬
scripts/get_actual_row_counts.py   - è¡Œæ•°ç»Ÿè®¡è„šæœ¬
```

### é…ç½®æ–‡ä»¶
```
configs/mimiciv_unified.json       - Skill-seekers é…ç½®ï¼ˆå‚è€ƒï¼‰
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆ3æ­¥ï¼‰

### ç¬¬1æ­¥ï¼šæµ‹è¯•è¿æ¥ï¼ˆ30ç§’ï¼‰
```bash
cd /mnt/f/SaAki_Sofa_benchmark
conda activate rna-seq
python -c "from utils.db_helper import test_connection; test_connection('mimic')"
```

### ç¬¬2æ­¥ï¼šç¬¬ä¸€ä¸ªæŸ¥è¯¢ï¼ˆ1åˆ†é’Ÿï¼‰
```python
from utils.db_helper import query_to_df

# æŸ¥è¯¢è„“æ¯’ç—‡æ‚£è€…
df = query_to_df("""
    SELECT * FROM mimiciv_derived.sepsis3
    WHERE sepsis3 = true
    LIMIT 10;
""", db='mimic')

print(df)
```

### ç¬¬3æ­¥ï¼šå¼€å§‹ç ”ç©¶ï¼ˆéšæ—¶ï¼‰
- æŸ¥çœ‹ [å¿«é€Ÿå¼€å§‹æŒ‡å—](docs/å®Œæ•´æµç¨‹æ–‡æ¡£/02_å¿«é€Ÿå¼€å§‹æŒ‡å—.md)
- ä½¿ç”¨ [å…³é”®èµ„æºé€ŸæŸ¥è¡¨](docs/å®Œæ•´æµç¨‹æ–‡æ¡£/03_å…³é”®èµ„æºé€ŸæŸ¥è¡¨.md) ä½œä¸ºæ—¥å¸¸å‚è€ƒ
- å‚è€ƒ [SKILL.md](.claude/skills/mimiciv-data-extraction/SKILL.md) è·å–è¯¦ç»† SQL æ¨¡å¼

---

## ğŸ’¡ é‡è¦ç‰¹æ€§

### 1. é¢„è®¡ç®—è¡¨å¯ç›´æ¥ä½¿ç”¨
ä½ **ä¸éœ€è¦**ä»å¤´è®¡ç®—è¿™äº›ä¸´åºŠæ¦‚å¿µï¼š
- âœ… SOFA è¯„åˆ† â†’ ç›´æ¥ç”¨ `mimiciv_derived.first_day_sofa`
- âœ… Sepsis-3 â†’ ç›´æ¥ç”¨ `mimiciv_derived.sepsis3`
- âœ… KDIGO AKI â†’ ç›´æ¥ç”¨ `mimiciv_derived.kdigo_stages`
- âœ… é¦–æ—¥å®éªŒå®¤å€¼ â†’ ç›´æ¥ç”¨ `mimiciv_derived.first_day_lab`
- âœ… é¦–æ—¥ç”Ÿå‘½ä½“å¾ â†’ ç›´æ¥ç”¨ `mimiciv_derived.first_day_vitalsign`

**è¿™å°†èŠ‚çœå¤§é‡æ—¶é—´ï¼**

### 2. ItemID é€ŸæŸ¥åŠŸèƒ½
æŠ€èƒ½åŒ…å«å®Œæ•´çš„ ItemID å‚è€ƒï¼š
- ç”Ÿå‘½ä½“å¾ï¼šå¿ƒç‡ï¼ˆ220045ï¼‰ã€è¡€å‹ï¼ˆ220181ï¼‰ã€SpO2ï¼ˆ220277ï¼‰ç­‰
- å®éªŒå®¤ï¼šè‚Œé…ï¼ˆ50912ï¼‰ã€è¡€å°æ¿ï¼ˆ51265ï¼‰ã€èƒ†çº¢ç´ ï¼ˆ50885ï¼‰ç­‰
- è¡€æ°”ï¼šPaO2ï¼ˆ50821ï¼‰ã€FiO2ï¼ˆ50816ï¼‰ã€pHï¼ˆ50820ï¼‰ç­‰

### 3. SQL æŸ¥è¯¢æ¨¡æ¿
æŠ€èƒ½æä¾›å³ç”¨å‹ SQL æ¨¡å¼ï¼š
- æ‚£è€…é˜Ÿåˆ—é€‰æ‹©
- æ—¶é—´åºåˆ—æ•°æ®æå–
- å®éªŒå®¤å€¼æŸ¥è¯¢ï¼ˆå¸¦å‚è€ƒèŒƒå›´ï¼‰
- è¯ç‰©æš´éœ²çª—å£
- SOFA/Sepsis/AKI è®¡ç®—

### 4. å®Œæ•´ä¸­æ–‡æ–‡æ¡£
æ‰€æœ‰å…³é”®æµç¨‹å’Œæ“ä½œéƒ½æœ‰ä¸­æ–‡æ–‡æ¡£è¯´æ˜ï¼Œæ˜“äºç†è§£å’Œä½¿ç”¨ã€‚

---

## ğŸ“– æ–‡æ¡£ä½¿ç”¨æŒ‡å—

### æ–°æ‰‹ç”¨æˆ·
1. å…ˆè¯» [å®Œæ•´æµç¨‹æ€»ç»“](docs/å®Œæ•´æµç¨‹æ–‡æ¡£/01_å®Œæ•´æµç¨‹æ€»ç»“.md) äº†è§£å…¨è²Œ
2. ç„¶åçœ‹ [å¿«é€Ÿå¼€å§‹æŒ‡å—](docs/å®Œæ•´æµç¨‹æ–‡æ¡£/02_å¿«é€Ÿå¼€å§‹æŒ‡å—.md) ä¸Šæ‰‹
3. æ—¥å¸¸ä½¿ç”¨ [å…³é”®èµ„æºé€ŸæŸ¥è¡¨](docs/å®Œæ•´æµç¨‹æ–‡æ¡£/03_å…³é”®èµ„æºé€ŸæŸ¥è¡¨.md)

### è¿›é˜¶ç”¨æˆ·
1. æ·±å…¥ç ”ç©¶ [SKILL.md](.claude/skills/mimiciv-data-extraction/SKILL.md)
2. å‚è€ƒ [æ•°æ®åº“æ‘˜è¦](MIMICIV_Database_Summary.md) äº†è§£å®Œæ•´ç»“æ„
3. æ ¹æ®éœ€è¦æŸ¥çœ‹é€ŸæŸ¥è¡¨

### æ—¥å¸¸ä½¿ç”¨
- éœ€è¦ ItemIDï¼Ÿâ†’ [é€ŸæŸ¥è¡¨](docs/å®Œæ•´æµç¨‹æ–‡æ¡£/03_å…³é”®èµ„æºé€ŸæŸ¥è¡¨.md)
- éœ€è¦ SQL æ¨¡å¼ï¼Ÿâ†’ [é€ŸæŸ¥è¡¨](docs/å®Œæ•´æµç¨‹æ–‡æ¡£/03_å…³é”®èµ„æºé€ŸæŸ¥è¡¨.md) æˆ– [SKILL.md](.claude/skills/mimiciv-data-extraction/SKILL.md)
- éœ€è¦å¿«é€ŸæŸ¥è¯¢ï¼Ÿâ†’ [å¿«é€Ÿå¼€å§‹æŒ‡å—](docs/å®Œæ•´æµç¨‹æ–‡æ¡£/02_å¿«é€Ÿå¼€å§‹æŒ‡å—.md)

---

## ğŸ¯ ä½¿ç”¨æŠ€èƒ½çš„æ–¹å¼

### æ–¹å¼ 1ï¼šæŸ¥é˜…æŠ€èƒ½æ–‡æ¡£
```bash
# æŸ¥çœ‹å®Œæ•´æŠ€èƒ½
cat .claude/skills/mimiciv-data-extraction/SKILL.md

# æŸ¥çœ‹é€ŸæŸ¥è¡¨
cat docs/å®Œæ•´æµç¨‹æ–‡æ¡£/03_å…³é”®èµ„æºé€ŸæŸ¥è¡¨.md
```

### æ–¹å¼ 2ï¼šåœ¨ Claude Code ä¸­å¼•ç”¨
åœ¨å¯¹è¯ä¸­æé—®æ—¶å¼•ç”¨æŠ€èƒ½ï¼š
```
"ä½¿ç”¨ MIMIC-IV æŠ€èƒ½ï¼Œå¸®æˆ‘æå–è„“æ¯’ç—‡æ‚£è€…çš„é¦–æ—¥ SOFA è¯„åˆ†"

"æ ¹æ® MIMIC-IV æŠ€èƒ½ï¼Œå¦‚ä½•ä» chartevents æå–å¿ƒç‡æ•°æ®ï¼Ÿ"

"å‚è€ƒ MIMIC-IV æŠ€èƒ½çš„æ¨¡å¼ï¼Œæ„å»ºä¸€ä¸ªåŒ…å« AKI ä¿¡æ¯çš„æ‚£è€…é˜Ÿåˆ—"
```

### æ–¹å¼ 3ï¼šç›´æ¥ä½¿ç”¨ Python å·¥å…·
```python
from utils.db_helper import query_to_df, preview_table, get_table_info

# å¿«é€Ÿé¢„è§ˆè¡¨
df = preview_table('mimiciv_derived.sepsis3', db='mimic', n=10)

# æŸ¥çœ‹è¡¨ç»“æ„
info = get_table_info('mimiciv_derived.sepsis3', db='mimic')
```

---

## ğŸ› ï¸ æŠ€æœ¯ç»†èŠ‚

### ä½¿ç”¨çš„å·¥å…·å’ŒæŠ€æœ¯
- **skill-seekers** - Claude æŠ€èƒ½åˆ›å»ºå·¥å…·
- **PostgreSQL** - æ•°æ®åº“ï¼ˆWindows æœåŠ¡å™¨ï¼‰
- **Python 3.10** - ç¼–ç¨‹è¯­è¨€
- **psycopg2-binary** - PostgreSQL é€‚é…å™¨
- **SQLAlchemy** - SQL å·¥å…·åŒ…
- **pandas** - æ•°æ®åˆ†æ

### ç¯å¢ƒé…ç½®
- **ç³»ç»Ÿ**: WSL (Windows Subsystem for Linux)
- **Conda ç¯å¢ƒ**: rna-seq
- **ç½‘ç»œ**: Windows IP 172.19.160.1

### æ•°æ®åº“é…ç½®
- **ä¸»æœº**: 172.19.160.1
- **ç«¯å£**: 5432
- **æ•°æ®åº“**: mimiciv
- **ç”¨æˆ·**: postgres
- **Schema**: mimiciv_hosp, mimiciv_icu, mimiciv_derived

---

## ğŸ“Š é¢„è®¡ç®—è¡¨å®Œæ•´åˆ—è¡¨

### ä¸´åºŠè¯„åˆ†
- `sofa` - SOFA è¯„åˆ†æ—¶é—´åºåˆ—
- `first_day_sofa` - é¦–æ—¥ SOFA
- `apsiii` - APACHE III
- `sapsii` - SAPS II
- `oasis` - OASIS
- `lods` - LODS
- `sirs` - SIRS

### è„“æ¯’ç—‡å’Œæ„ŸæŸ“
- `sepsis3` - Sepsis-3 è¯†åˆ«
- `sepsis3_detail` - è¯¦ç»†ä¿¡æ¯
- `suspicion_of_infection` - æ„ŸæŸ“æ€€ç–‘

### æ€¥æ€§è‚¾æŸä¼¤
- `kdigo_stages` - AKI åˆ†æœŸ
- `kdigo_creatinine` - åŸºäºè‚Œé…
- `kdigo_uo` - åŸºäºå°¿é‡
- `creatinine_baseline` - åŸºçº¿è‚Œé…

### é¦–æ—¥æµ‹é‡
- `first_day_lab` - é¦–æ—¥å®éªŒå®¤
- `first_day_vitalsign` - é¦–æ—¥ç”Ÿå‘½ä½“å¾
- `first_day_urine_output` - é¦–æ—¥å°¿é‡
- `first_day_gcs` - é¦–æ—¥ GCS
- `first_day_bg` - é¦–æ—¥è¡€æ°”
- `first_day_height` - èº«é«˜
- `first_day_weight` - ä½“é‡

### è¯ç‰©
- `norepinephrine` - å»ç”²è‚¾ä¸Šè…ºç´ 
- `epinephrine` - è‚¾ä¸Šè…ºç´ 
- `dopamine` - å¤šå·´èƒº
- `vasopressin` - åŠ å‹ç´ 
- `vasoactive_agent` - è¡€ç®¡æ´»æ€§è¯ç‰©

### ç”Ÿå‘½æ”¯æŒ
- `ventilation` - æœºæ¢°é€šæ°”
- `ventilator_setting` - å‘¼å¸æœºè®¾ç½®
- `rrt` - è‚¾è„æ›¿ä»£æ²»ç–—
- `crrt` - è¿ç»­è‚¾è„æ›¿ä»£

### å®éªŒå®¤é¢æ¿
- `chemistry` - ç”ŸåŒ–
- `complete_blood_count` - è¡€å¸¸è§„
- `coagulation` - å‡è¡€
- `cardiac_marker` - å¿ƒè‚Œæ ‡å¿—ç‰©
- `bg` - è¡€æ°”

---

## ğŸ“ å­¦ä¹ å»ºè®®

### ç¬¬1å¤©
- âœ… æµ‹è¯•æ•°æ®åº“è¿æ¥
- âœ… è¿è¡Œç¬¬ä¸€ä¸ªæŸ¥è¯¢
- âœ… æµè§ˆé€ŸæŸ¥è¡¨

### ç¬¬1å‘¨
- ç†Ÿæ‚‰å¸¸ç”¨ ItemID
- ç»ƒä¹  SQL æŸ¥è¯¢æ¨¡æ¿
- æ¢ç´¢é¢„è®¡ç®—è¡¨

### ç¬¬1æœˆ
- æ„å»ºå®Œæ•´æ‚£è€…é˜Ÿåˆ—
- æå–ä¸´åºŠæ•°æ®
- è¿›è¡Œåˆæ­¥åˆ†æ

---

## ğŸ’¬ è·å–å¸®åŠ©

### æŸ¥çœ‹æ–‡æ¡£
- **å®Œæ•´æµç¨‹**: `docs/å®Œæ•´æµç¨‹æ–‡æ¡£/01_å®Œæ•´æµç¨‹æ€»ç»“.md`
- **å¿«é€Ÿå¼€å§‹**: `docs/å®Œæ•´æµç¨‹æ–‡æ¡£/02_å¿«é€Ÿå¼€å§‹æŒ‡å—.md`
- **é€ŸæŸ¥è¡¨**: `docs/å®Œæ•´æµç¨‹æ–‡æ¡£/03_å…³é”®èµ„æºé€ŸæŸ¥è¡¨.md`
- **æŠ€èƒ½æ–‡æ¡£**: `.claude/skills/mimiciv-data-extraction/SKILL.md`
- **æ•°æ®åº“æ‘˜è¦**: `MIMICIV_Database_Summary.md`

### ä½¿ç”¨ Claude Code
åœ¨å¯¹è¯ä¸­å¼•ç”¨æŠ€èƒ½è·å–å¸®åŠ©ï¼š
```
"ä½¿ç”¨ MIMIC-IV æŠ€èƒ½ï¼Œå¸®æˆ‘..."
```

### è¿è¡Œç¤ºä¾‹
```bash
ls examples/
python examples/quick_query_example.py
```

---

## âœ… æ£€æŸ¥æ¸…å•

### å®‰è£…å’Œé…ç½®
- [x] skill-seekers å·¥å…·å·²å®‰è£…
- [x] PostgreSQL è¿æ¥å·²é…ç½®
- [x] Python ä¾èµ–å·²å®‰è£…ï¼ˆpsycopg2, sqlalchemyï¼‰
- [x] æ•°æ®åº“è¿æ¥æµ‹è¯•æˆåŠŸ

### æŠ€èƒ½å’Œæ–‡æ¡£
- [x] MIMIC-IV æŠ€èƒ½å·²åˆ›å»ºï¼ˆ28KBï¼‰
- [x] ä¸­æ–‡æ–‡æ¡£å·²åˆ›å»ºï¼ˆ4ä¸ªæ–‡æ¡£ï¼‰
- [x] è‹±æ–‡æ–‡æ¡£å·²åˆ›å»ºï¼ˆ3ä¸ªæ–‡æ¡£ï¼‰
- [x] ç¤ºä¾‹è„šæœ¬å·²æä¾›

### æ•°æ®åº“
- [x] æ•°æ®åº“ç»“æ„å·²æ¢ç´¢
- [x] è¡¨ç»Ÿè®¡å·²è·å–
- [x] é¢„è®¡ç®—è¡¨å·²è¯†åˆ«
- [x] è¡¨å…³ç³»å·²åˆ†æ

---

## ğŸš€ ç°åœ¨å¯ä»¥åšä»€ä¹ˆï¼Ÿ

### ç«‹å³å¼€å§‹
ä½ ç°åœ¨æ‹¥æœ‰ï¼š
- âœ… å®Œæ•´é…ç½®çš„æ•°æ®åº“è¿æ¥
- âœ… 364,627 æ‚£è€…æ•°æ®
- âœ… 41,295 è¯†åˆ«çš„è„“æ¯’ç—‡ç—…ä¾‹
- âœ… é¢„è®¡ç®—çš„ SOFAã€AKI è¯„åˆ†
- âœ… å®Œæ•´çš„æŠ€èƒ½å’Œæ–‡æ¡£
- âœ… å³ç”¨å‹ SQL æŸ¥è¯¢æ¨¡æ¿

### å»ºè®®çš„ç¬¬ä¸€ä¸ªé¡¹ç›®
æ„å»ºè„“æ¯’ç—‡æ‚£è€…é˜Ÿåˆ—å¹¶åˆ†æé¦–æ—¥ SOFA è¯„åˆ†ï¼š

```python
from utils.db_helper import query_to_df

# è·å–è„“æ¯’ç—‡æ‚£è€…çš„å®Œæ•´æ•°æ®
sepsis_cohort = query_to_df("""
    SELECT
        s.subject_id,
        s.stay_id,
        s.sofa_24hours,
        fs.respiration_24hours,
        fs.coagulation_24hours,
        fs.liver_24hours,
        fs.cardiovascular_24hours,
        fs.cns_24hours,
        fs.renal_24hours,
        ie.los,
        p.anchor_age,
        a.hospital_expire_flag
    FROM mimiciv_derived.sepsis3 s
    JOIN mimiciv_derived.first_day_sofa fs ON s.stay_id = fs.stay_id
    JOIN mimiciv_icu.icustays ie ON s.stay_id = ie.stay_id
    JOIN mimiciv_hosp.patients p ON s.subject_id = p.subject_id
    JOIN mimiciv_hosp.admissions a ON s.hadm_id = a.hadm_id
    WHERE s.sepsis3 = true
      AND p.anchor_age >= 18
""", db='mimic')

print(f"è„“æ¯’ç—‡é˜Ÿåˆ—: {len(sepsis_cohort)} æ‚£è€…")
print(f"å¹³å‡ SOFA: {sepsis_cohort['sofa_24hours'].mean():.2f}")
print(f"æ­»äº¡ç‡: {sepsis_cohort['hospital_expire_flag'].mean()*100:.1f}%")

# ä¿å­˜
sepsis_cohort.to_csv('output/sepsis_cohort.csv', index=False)
```

---

## ğŸ“ æ”¯æŒå’Œåé¦ˆ

å¦‚æœ‰é—®é¢˜æˆ–éœ€è¦å¸®åŠ©ï¼š
1. æŸ¥é˜…ç›¸å…³æ–‡æ¡£
2. åœ¨ Claude Code ä¸­å¼•ç”¨æŠ€èƒ½æé—®
3. æŸ¥çœ‹ç¤ºä¾‹è„šæœ¬

---

**ğŸ‰ æ­å–œï¼é¡¹ç›®å·²å®Œå…¨å°±ç»ªï¼Œå¯ä»¥å¼€å§‹ä½ çš„ MIMIC-IV æ•°æ®åˆ†æäº†ï¼**

---

**åˆ›å»ºæ—¥æœŸ**: 2025å¹´11æœˆ14æ—¥
**é¡¹ç›®**: SaAki_Sofa_benchmark
**çŠ¶æ€**: âœ… å®Œæˆ
**ä½œè€…**: Claude AI
